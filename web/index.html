<html>
<head>
<title>weblog</title>
</head>
<body>
	web-log[status:
	<span id="status">wait connect server</span>]
	<hr>
	<textarea id="mem" rows="38" cols="150"
		style="background: black; color: white" readonly="readonly"></textarea>
</body>
<script type="text/javascript">
	var ws = new WebSocket("ws://" + window.location.host + "/ws");
	var st = document.getElementById("status");
	var msg = document.getElementById("mem");
	var line = 0;

	ws.onopen = function() {
		st.innerText = "connected to service";
	};

	ws.onmessage = function(e) {
		printmsg(e.data);
	};
	ws.onclose = function() {
		printmsg("connect closed");
	};
	ws.onerror = function(e) {
		printmsg("recv error:" + e);
	};

	function printmsg(str) {
		if (line++ < 50) {
			msg.value += str;
		} else {
			msg.value = str;
			line = 1;
		}
	}
</script>
</html>